Content-Type: multipart/mixed; boundary="==AWS=="
MIME-Version: 1.0

--==AWS==
Content-Type: text/x-shellscript; charset="us-ascii"
MIME-Version: 1.0

config system global
set hostname "FortiGate-GWLB-HA-Passive"
set admin-sport ${adminsport}
end
config system interface
edit port1
set alias public
set mode static
set ip ${port1_ip} ${port1_mask}
set allowaccess ping https ssh fgfm
set mtu-override enable
set mtu 9001
next
edit port2
set alias private
set mode static
set ip ${port2_ip} ${port2_mask}
set allowaccess ping https ssh fgfm probe-response
set defaultgw disable
set mtu-override enable
set mtu 9001
next
edit port3
set alias hasync
set mode static
set ip ${port3_ip} ${port3_mask}
set allowaccess ping https ssh fgfm
set mtu-override enable
set mtu 9001
next
edit port4
set alias hamgmt
set mode static
set ip ${port4_ip} ${port4_mask}
set allowaccess ping https ssh fgfm
set mtu-override enable
set mtu 9001
next
end
config system probe-response
set mode http-probe
end
config sys ha
set group-name "AWS-GWLB-HA"
set priority 100
set mode a-p
set hbdev port3 100
set session-pickup enable
set ha-mgmt-status enable
config ha-mgmt-interfaces
edit 1
set interface port4
set gateway ${port4_gateway}
next
end
set override enable
set priority 100
set password ftnt123456
set unicast-hb enable
set unicast-hb-peerip ${active_peerip}
end
config router static
edit 1
set device port1
set gateway ${port1_gateway}
next
end
config system sdn-connector
edit aws-ha
set type aws
set use-metadata-iam enable
next
end
config system vdom-exception
edit 1
set object system.interface
next
edit 2
set object router.static
next
edit 3
set object firewall.vip
next
end
config system geneve
edit "awsgeneve"
set interface "port2"
set type ppp
set remote-ip ${endpointip}
next
edit "awsgeneve2"
set interface "port2"
set type ppp
set remote-ip ${endpointip2}
next
end
config system zone
edit awszone
set interface awsgeneve awsgeneve2
next
end
config firewall policy
edit 1
set name "GWLB-Inspection"
set srcintf "awszone"
set dstintf "awszone"
set srcaddr "all"
set dstaddr "all"
set action accept
set schedule "always"
set service "ALL"
set logtraffic all
next
end
config router static
edit 2
set device awsgeneve
next
edit 3
set device awsgeneve2
next
end
config router policy
edit 1
set input-device "awsgeneve"
set src "0.0.0.0/0.0.0.0"
set dst "0.0.0.0/0.0.0.0"
set output-device "awsgeneve"
next
edit 2
set input-device "awsgeneve2"
set src "0.0.0.0/0.0.0.0"
set dst "0.0.0.0/0.0.0.0"
set output-device "awsgeneve2"
next
end

--==AWS==--